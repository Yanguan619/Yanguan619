## Docker Compose

在实际的使用中，往往需要各种环境，安装各种软件和 Python 依赖，比如想要搭建一个 Web 开发环境，要有数据库、nginx、Python、Web 框架、缓存等等，当然还是可以基于`ubuntu:19.04`这种操作系统镜像，在 Dockerfile 里面写复杂的逻辑，挨个安装相关的软件和 Python 依赖。不过这样做有一些缺点:

1. 不利于分享和复用。一般这种方式产生的镜像比较大，且由于里面堆了很多别人用不到的东西，不具备复用的价值
2. 无法共享数据。应用只能连接到自己内部，如果共享镜像里的数据要配置复杂的端口转发，且容易出错

>  把全部东西堆到一个容器里面是典型的虚拟机的使用方式，不是 Docker 的正确打开方式。

正确的做法是让一个容器做一件事：数据库、nginx、python 应用、缓存等等都是独立的容器，分别启动它们，这些容器组成了一个集群，需要某种方法把它们关联起来。

这个关联有一个非常专用、形象的称呼「编排」，而 Docker Compose 大家可以猜到就是负责实现对 Docker 容器集群编排的。

### 例

`Dockerfile`

构建一套包含 lyanna 所需全部环境的容器集群，这个容器集群包含:

1. db。存放博客、用户、表态、评论等数据。
2. redis。存放博客文章内容以及作为消息代理。
3. memcached。缓存。
4. web。lyanna 应用。

`docker-compose.yml`